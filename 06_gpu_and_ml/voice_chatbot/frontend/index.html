<h1>wip</h1>
<div style="position: relative">
  <video
    id="video"
    width="480"
    autoplay
    muted
    style="position: relative; top: 0; left: 0"
  ></video
  ><br />
  <img id="outputImg" style="position: absolute; top: 0; left: 0" />
  <div
    id="message"
    style="position: absolute; top: 0; left: 0; color: red"
  ></div>
</div>

<script>
  const getNextFrameLoop = async (stream) => {
    const context = new AudioContext();
    const source = context.createMediaStreamSource(stream);

    await context.audioWorklet.addModule("processor.js");
    const worklet = new AudioWorkletNode(context, "worklet-processor");

    source.connect(worklet);
    worklet.connect(context.destination);
  };

  navigator.mediaDevices
    .getUserMedia({ audio: true })
    .then(getNextFrameLoop)
    .catch((e) => {
      message.textContent = e.name + ": " + e.message;
    });
</script>
